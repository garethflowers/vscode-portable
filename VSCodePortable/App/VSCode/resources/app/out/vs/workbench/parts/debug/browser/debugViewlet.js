/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
define("vs/css!vs/workbench/parts/debug/browser/media/debugViewlet",["vs/css!vs/workbench/parts/debug/browser/debugViewlet"],{});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},__decorate=this&&this.__decorate||function(e,t,i,n){if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)return Reflect.decorate(e,t,i,n);switch(arguments.length){case 2:return e.reduceRight(function(e,t){return t&&t(e)||e},t);case 3:return e.reduceRight(function(e,n){return void(n&&n(t,i))},void 0);case 4:return e.reduceRight(function(e,n){return n&&n(t,i,e)||e},n)}},__param=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};define("vs/workbench/parts/debug/browser/debugActionItems",["require","exports","vs/base/common/lifecycle","vs/base/common/errors","vs/base/browser/dom","vs/base/browser/ui/actionbar/actionbar","vs/workbench/parts/debug/common/debug","vs/platform/configuration/common/configuration"],function(e,t,i,n,s,r,o,a){var c=function(e){function t(t,i,n){e.call(this,null,t),this.debugService=i,this.select=document.createElement("select"),this.select.className="debug-select action-bar-select",this.toDispose=[],this.registerListeners(n)}return __extends(t,e),t.prototype.registerListeners=function(e){var t=this;this.toDispose.push(s.addStandardDisposableListener(this.select,"change",function(e){t.actionRunner.run(t._action,e.target.value).done(null,n.onUnexpectedError)})),this.toDispose.push(this.debugService.addListener2(o.ServiceEvents.STATE_CHANGED,function(){t.select.disabled=t.debugService.getState()!==o.State.Inactive})),this.toDispose.push(e.addListener2(a.ConfigurationServiceEventTypes.UPDATED,function(e){t.setOptions().done(null,n.onUnexpectedError)}))},t.prototype.render=function(e){s.addClass(e,"select-container"),e.appendChild(this.select),this.setOptions().done(null,n.onUnexpectedError)},t.prototype.setOptions=function(){var e=this,t=this.select.selectedIndex;return this.select.options.length=0,this.debugService.loadLaunchConfig().then(function(i){if(!i||!i.configurations)return e.select.options.add(e.createOption("<none>")),void(e.select.disabled=!0);var n=i.configurations;e.select.disabled=n.length<1;for(var s=!1,r=e.debugService.getConfiguration(),o=0;o<n.length;o++)e.select.options.add(e.createOption(n[o].name)),r&&r.name===n[o].name&&(e.select.selectedIndex=o,s=!0);return!s&&n.length>0?((!t||0>t||t>=n.length)&&(t=0),e.select.selectedIndex=t,e.actionRunner.run(e._action,n[t].name)):void 0})},t.prototype.createOption=function(e){var t=document.createElement("option");return t.value=e,t.text=e,t},t.prototype.dispose=function(){this.debugService=null,this.toDispose=i.disposeAll(this.toDispose),e.prototype.dispose.call(this)},t=__decorate([__param(1,o.IDebugService),__param(2,a.IConfigurationService)],t)}(r.BaseActionItem);t.SelectConfigActionItem=c});var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},__decorate=this&&this.__decorate||function(e,t,i,n){if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)return Reflect.decorate(e,t,i,n);switch(arguments.length){case 2:return e.reduceRight(function(e,t){return t&&t(e)||e},t);case 3:return e.reduceRight(function(e,n){return void(n&&n(t,i))},void 0);case 4:return e.reduceRight(function(e,n){return n&&n(t,i,e)||e},n)}},__param=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};define("vs/workbench/parts/debug/browser/debugViewlet",["require","exports","vs/nls!vs/workbench/parts/debug/browser/debugViewlet","vs/base/browser/dom","vs/base/browser/builder","vs/base/common/winjs.base","vs/base/common/errors","vs/base/common/lifecycle","vs/base/common/events","vs/workbench/browser/actionBarRegistry","vs/base/parts/tree/browser/treeImpl","vs/base/browser/ui/splitview/splitview","vs/workbench/common/memento","vs/workbench/browser/viewlet","vs/workbench/parts/debug/common/debug","vs/workbench/parts/debug/common/debugModel","vs/workbench/parts/debug/browser/debugViewer","vs/workbench/parts/debug/browser/debugActions","vs/workbench/parts/debug/browser/debugActionItems","vs/platform/contextview/browser/contextView","vs/platform/instantiation/common/instantiation","vs/platform/progress/common/progress","vs/platform/workspace/common/workspace","vs/platform/telemetry/common/telemetry","vs/platform/message/common/message","vs/platform/storage/common/storage","vs/css!./media/debugViewlet"],function(e,t,i,n,s,r,o,a,c,p,d,l,u,h,v,g,S,b,f,m,E,w,_,A,x,y){function I(e){var t=document.createElement("div");return n.addClass(t,"debug-view-content"),e.appendChild(t),t}var C=v.IDebugService,D={indentPixels:8,twistiePixels:20},M=s.$,L=function(e){function t(i,n,s,r,o,a){e.call(this,i,!!n[t.MEMENTO],"variablesView",s,r),this.settings=n,this.debugService=o,this.instantiationService=a}return __extends(t,e),t.prototype.renderHeader=function(t){e.prototype.renderHeader.call(this,t);var n=M("div.title").appendTo(t);M("span").text(i.localize(0,null)).appendTo(n)},t.prototype.renderBody=function(e){var t=this;this.treeContainer=I(e),n.addClass(this.treeContainer,"debug-variables"),this.tree=new d.Tree(this.treeContainer,{dataSource:new S.VariablesDataSource(this.debugService),renderer:this.instantiationService.createInstance(S.VariablesRenderer),controller:new S.BaseDebugController(this.debugService,this.contextMenuService,new S.VariablesActionProvider(this.instantiationService))},D);var i=this.debugService.getViewModel();this.tree.setInput(i);var s=this.instantiationService.createInstance(h.CollapseAction,this.tree,!1,"explorer-action collapse-explorer");this.toolBar.setActions(p.prepareActions([s]))(),this.toDispose.push(i.addListener2(v.ViewModelEvents.FOCUSED_STACK_FRAME_UPDATED,function(){return t.onFocusedStackFrameUpdated()})),this.toDispose.push(this.debugService.addListener2(v.ServiceEvents.STATE_CHANGED,function(){s.enabled=t.debugService.getState()===v.State.Running||t.debugService.getState()===v.State.Stopped}))},t.prototype.onFocusedStackFrameUpdated=function(){var e=this;this.tree.refresh().then(function(){var t=e.debugService.getViewModel().getFocusedStackFrame();return t?t.getScopes(e.debugService).then(function(t){return t.length>0?e.tree.expand(t[0]):void 0}):void 0}).done(null,o.onUnexpectedError)},t.prototype.shutdown=function(){this.settings[t.MEMENTO]=this.state===l.CollapsibleState.COLLAPSED,e.prototype.shutdown.call(this)},t.MEMENTO="variablesview.memento",t=__decorate([__param(2,x.IMessageService),__param(3,m.IContextMenuService),__param(4,C),__param(5,E.IInstantiationService)],t)}(h.CollapsibleViewletView),B=function(e){function t(i,n,s,r,o,a){var c=this;e.call(this,i,!!n[t.MEMENTO],"expressionsView",s,r),this.settings=n,this.debugService=o,this.instantiationService=a,this.toDispose.push(this.debugService.getModel().addListener2(v.ModelEvents.WATCH_EXPRESSIONS_UPDATED,function(e){e instanceof g.Expression&&c.expand()}))}return __extends(t,e),t.prototype.renderHeader=function(t){e.prototype.renderHeader.call(this,t);var n=M("div.title").appendTo(t);M("span").text(i.localize(1,null)).appendTo(n)},t.prototype.renderBody=function(e){var t=this;this.treeContainer=I(e),n.addClass(this.treeContainer,"debug-watch");var i=new S.WatchExpressionsActionProvider(this.instantiationService);this.tree=new d.Tree(this.treeContainer,{dataSource:new S.WatchExpressionsDataSource(this.debugService),renderer:this.instantiationService.createInstance(S.WatchExpressionsRenderer,i,this.actionRunner),controller:new S.WatchExpressionsController(this.debugService,this.contextMenuService,i)},D),this.tree.setInput(this.debugService.getModel());var s=this.instantiationService.createInstance(b.AddWatchExpressionAction,b.AddWatchExpressionAction.ID,b.AddWatchExpressionAction.LABEL),r=this.instantiationService.createInstance(h.CollapseAction,this.tree,!1,"explorer-action collapse-explorer"),a=this.instantiationService.createInstance(b.RemoveAllWatchExpressionsAction,b.RemoveAllWatchExpressionsAction.ID,b.RemoveAllWatchExpressionsAction.LABEL);this.toolBar.setActions(p.prepareActions([s,r,a]))(),this.toDispose.push(this.debugService.getModel().addListener2(v.ModelEvents.WATCH_EXPRESSIONS_UPDATED,function(e){return t.onWatchExpressionsUpdated(e)})),this.toDispose.push(this.debugService.getViewModel().addListener2(v.ViewModelEvents.SELECTED_EXPRESSION_UPDATED,function(e){e&&e instanceof g.Expression&&t.tree.refresh(e,!1).then(function(){t.tree.setHighlight(e);var i=t.tree.addListener(c.EventType.HIGHLIGHT,function(n){n.highlight||(t.debugService.getViewModel().setSelectedExpression(null),t.tree.refresh(e).done(null,o.onUnexpectedError),i())})}).done(null,o.onUnexpectedError)}))},t.prototype.onWatchExpressionsUpdated=function(e){var t=this;this.tree.refresh().done(function(){return e instanceof g.Expression?t.tree.reveal(e):r.Promise.as(!0)},o.onUnexpectedError)},t.prototype.shutdown=function(){this.settings[t.MEMENTO]=this.state===l.CollapsibleState.COLLAPSED,e.prototype.shutdown.call(this)},t.MEMENTO="watchexpressionsview.memento",t=__decorate([__param(2,x.IMessageService),__param(3,m.IContextMenuService),__param(4,C),__param(5,E.IInstantiationService)],t)}(h.CollapsibleViewletView),T=function(e){function t(i,n,s,r,o,a){e.call(this,i,!!n[t.MEMENTO],"callStackView",s,r),this.settings=n,this.debugService=o,this.instantiationService=a}return __extends(t,e),t.prototype.renderHeader=function(t){e.prototype.renderHeader.call(this,t);var n=M("div.title").appendTo(t);M("span").text(i.localize(2,null)).appendTo(n)},t.prototype.renderBody=function(e){var t=this;this.renderMessageBox(e),this.treeContainer=I(e),n.addClass(this.treeContainer,"debug-call-stack"),this.tree=new d.Tree(this.treeContainer,{dataSource:new S.CallStackDataSource,renderer:this.instantiationService.createInstance(S.CallStackRenderer)},D);var s=this.debugService.getModel();this.tree.setInput(s),this.toDispose.push(this.tree.addListener2("selection",function(e){if(e.selection.length){var i=e.selection[0];if(i instanceof g.StackFrame){var n=i;t.debugService.setFocusedStackFrameAndEvaluate(n);var s="mouse"===e.payload.origin,r=s,a=e&&e.payload&&e.payload.originalEvent;a&&s&&2===a.detail&&(r=!1,a.preventDefault());var c=a&&(a.ctrlKey||a.metaKey);t.debugService.openOrRevealEditor(n.source,n.lineNumber,r,c).done(null,o.onUnexpectedError)}}})),this.toDispose.push(s.addListener2(v.ModelEvents.CALLSTACK_UPDATED,function(){t.tree.refresh().done(null,o.onUnexpectedError)})),this.toDispose.push(this.debugService.addListener2(v.ServiceEvents.STATE_CHANGED,function(e){return t.debugService.getState()===v.State.Stopped&&"step"!==e?(t.messageBox.textContent=i.localize(3,null,e),"exception"===e?t.messageBox.classList.add("exception"):t.messageBox.classList.remove("exception"),void(t.messageBox.hidden=!1)):void(t.messageBox.hidden=!0)})),this.toDispose.push(this.debugService.getViewModel().addListener2(v.ViewModelEvents.FOCUSED_STACK_FRAME_UPDATED,function(){var e=t.debugService.getViewModel().getFocusedStackFrame();if(e){var i=t.debugService.getModel().getThreads();for(var n in i)i[n].callStack.some(function(t){return t===e})&&t.tree.expand(i[n]);t.tree.setFocus(e)}}))},t.prototype.renderMessageBox=function(e){this.messageBox=document.createElement("div"),n.addClass(this.messageBox,"debug-message-box"),this.messageBox.hidden=!0,e.appendChild(this.messageBox)},t.prototype.shutdown=function(){this.settings[t.MEMENTO]=this.state===l.CollapsibleState.COLLAPSED,e.prototype.shutdown.call(this)},t.MEMENTO="callstackview.memento",t=__decorate([__param(2,x.IMessageService),__param(3,m.IContextMenuService),__param(4,C),__param(5,E.IInstantiationService)],t)}(h.CollapsibleViewletView),k=function(e){function t(i,n,s,r,o,a){var c=this;e.call(this,i,t.getExpandedBodySize(o.getModel().getBreakpoints().length+o.getModel().getExceptionBreakpoints().length),!!n[t.MEMENTO],"breakpointsView",s,r),this.settings=n,this.debugService=o,this.instantiationService=a,this.toDispose.push(this.debugService.getModel().addListener2(v.ModelEvents.BREAKPOINTS_UPDATED,function(){return c.onBreakpointsChange()}))}return __extends(t,e),t.prototype.renderHeader=function(t){e.prototype.renderHeader.call(this,t);var n=M("div.title").appendTo(t);M("span").text(i.localize(4,null)).appendTo(n)},t.prototype.renderBody=function(e){var t=this;this.treeContainer=I(e),n.addClass(this.treeContainer,"debug-breakpoints");var i=new S.BreakpointsActionProvider(this.instantiationService);this.tree=new d.Tree(this.treeContainer,{dataSource:new S.BreakpointsDataSource,renderer:this.instantiationService.createInstance(S.BreakpointsRenderer,i,this.actionRunner),controller:new S.BreakpointsController(this.debugService,this.contextMenuService,i),sorter:{compare:function(e,t,i){var n=t,s=i;return n instanceof g.ExceptionBreakpoint?-1:s instanceof g.ExceptionBreakpoint?1:n.source.uri.toString()!==s.source.uri.toString()?n.source.uri.toString().localeCompare(s.source.uri.toString()):n.desiredLineNumber-s.desiredLineNumber}}},D);var s=this.debugService.getModel();this.tree.setInput(s),this.toDispose.push(this.tree.addListener2("selection",function(e){if(e.selection.length){var i=e.selection[0];if(i instanceof g.Breakpoint){var n=i;if(!n.source.inMemory){var s="mouse"===e.payload.origin,r=s,a=e&&e.payload&&e.payload.originalEvent;a&&s&&2===a.detail&&(r=!1,a.preventDefault());var c=a&&(a.ctrlKey||a.metaKey);t.debugService.openOrRevealEditor(n.source,n.lineNumber,r,c).done(null,o.onUnexpectedError)}}}}))},t.prototype.getActions=function(){return[this.instantiationService.createInstance(b.ReapplyBreakpointsAction,b.ReapplyBreakpointsAction.ID,b.ReapplyBreakpointsAction.LABEL),this.instantiationService.createInstance(b.ToggleBreakpointsActivatedAction,b.ToggleBreakpointsActivatedAction.ID,b.ToggleBreakpointsActivatedAction.LABEL),this.instantiationService.createInstance(b.RemoveAllBreakpointsAction,b.RemoveAllBreakpointsAction.ID,b.RemoveAllBreakpointsAction.LABEL)]},t.prototype.onBreakpointsChange=function(){this.expandedBodySize=t.getExpandedBodySize(this.debugService.getModel().getBreakpoints().length+this.debugService.getModel().getExceptionBreakpoints().length),this.tree&&this.tree.refresh()},t.getExpandedBodySize=function(e){return 24*Math.min(t.MAX_VISIBLE_FILES,e)},t.prototype.shutdown=function(){this.settings[t.MEMENTO]=this.state===l.CollapsibleState.COLLAPSED,e.prototype.shutdown.call(this)},t.MAX_VISIBLE_FILES=9,t.MEMENTO="breakopintsview.memento",t=__decorate([__param(2,x.IMessageService),__param(3,m.IContextMenuService),__param(4,C),__param(5,E.IInstantiationService)],t)}(h.AdaptiveCollapsibleViewletView),R=function(e){function t(t,i,n,s,r,o){var a=this;e.call(this,v.VIEWLET_ID,t),this.progressService=i,this.debugService=n,this.instantiationService=s,this.contextService=r,this.progressRunner=null,this.viewletSettings=this.getMemento(o,u.Scope.WORKSPACE),this.views=[],this.toDispose=[],this.toDispose.push(this.debugService.addListener2(v.ServiceEvents.STATE_CHANGED,function(){a.onDebugServiceStateChange()}))}return __extends(t,e),t.prototype.create=function(t){var n=this;if(e.prototype.create.call(this,t),this.$el=t.div().addClass("debug-viewlet"),this.contextService.getWorkspace()){var s=this.getActionRunner();this.views.push(this.instantiationService.createInstance(L,s,this.viewletSettings)),this.views.push(this.instantiationService.createInstance(B,s,this.viewletSettings)),this.views.push(this.instantiationService.createInstance(T,s,this.viewletSettings)),this.views.push(this.instantiationService.createInstance(k,s,this.viewletSettings)),this.splitView=new l.SplitView(this.$el.getHTMLElement()),this.toDispose.push(this.splitView),this.views.forEach(function(e){return n.splitView.addView(e)})}else this.$el.append(M(['<div class="noworkspace-view">',"<p>",i.localize(5,null),"</p>","<p>",i.localize(6,null),"</p>","</div>"].join("")));return r.Promise.as(null)},t.prototype.layout=function(e){this.splitView&&this.splitView.layout(e.height)},t.prototype.getActions=function(){var e=this;return this.debugService.getState()===v.State.Disabled?[]:(this.actions||(this.actions=[this.instantiationService.createInstance(b.StartDebugAction,b.StartDebugAction.ID,b.StartDebugAction.LABEL),this.instantiationService.createInstance(b.SelectConfigAction,b.SelectConfigAction.ID,b.SelectConfigAction.LABEL),this.instantiationService.createInstance(b.ConfigureAction,b.ConfigureAction.ID,b.ConfigureAction.LABEL),this.instantiationService.createInstance(b.OpenReplAction,b.OpenReplAction.ID,b.OpenReplAction.LABEL)],this.actions.forEach(function(t){e.toDispose.push(t)})),this.actions)},t.prototype.getActionItem=function(e){return e.id===b.SelectConfigAction.ID?this.instantiationService.createInstance(f.SelectConfigActionItem,e):null},t.prototype.getSecondaryActions=function(){return[]},t.prototype.onDebugServiceStateChange=function(){this.progressRunner&&this.progressRunner.done(),this.debugService.getState()===v.State.Initializing?this.progressRunner=this.progressService.show(!0):this.progressRunner=null},t.prototype.dispose=function(){this.toDispose=a.disposeAll(this.toDispose),e.prototype.dispose.call(this)},t.prototype.shutdown=function(){this.views.forEach(function(e){return e.shutdown()}),e.prototype.shutdown.call(this)},t=__decorate([__param(0,A.ITelemetryService),__param(1,w.IProgressService),__param(2,C),__param(3,E.IInstantiationService),__param(4,_.IWorkspaceContextService),__param(5,y.IStorageService)],t)}(h.Viewlet);t.DebugViewlet=R});